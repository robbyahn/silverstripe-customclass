{"version":3,"sources":["webpack:///webpack/bootstrap c9882f9a36b9bd3804f4","webpack:////work-and-income/~/react-dom/client.js","webpack:///./client/src/TinyMCE_sslink-customclass.js","webpack:///./client/src/lang/en.js","webpack:///external \"ReactDom\"","webpack:///external \"Injector\"","webpack:///external \"InsertLinkModal\"","webpack:///external \"React\"","webpack:///external \"ShortcodeSerialiser\"","webpack:///external \"TinyMCEActionRegistrar\"","webpack:///external \"i18n\"","webpack:///external \"jQuery\""],"names":["commandName","TinyMCEActionRegistrar","addAction","text","i18n","_t","onclick","editor","execCommand","priority","addCommandWithUrlTest","plugin","init","addCommand","field","window","jQuery","id","entwine","openLinkCustomClassDiaglog","modalId","sectionConfigKey","formName","InsertLinkCustomClassModal","$","dialog","console","log","length","append","addClass","setElement","open","renderModal","isOpen","handleHide","close","handleInsert","attrs","getOriginalAttributes","selection","tinymce","activeEditor","selectionContent","getContent","tagName","getNode","requireLinkText","trim","ReactDOM","render","getElement","getEditor","node","getSelectedNode","hrefParts","attr","split","shortcode","ShortcodeSerialiser","match","PageID","properties","parseInt","Anchor","Description","TargetBlank","CustomClass","buildAttributes","data","serialise","name","anchor","href","target","title","class","PluginManager","add","error","addDictionary"],"mappings":"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","file":"js/TinyMCE_sslink-customclass.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./client/src/TinyMCE_sslink-customclass.js\");\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c9882f9a36b9bd3804f4","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /work-and-income/~/react-dom/client.js\n// module id = ../../../node_modules/react-dom/client.js\n// module chunks = 0","/* global tinymce, window */\nimport i18n from 'i18n';\nimport TinyMCEActionRegistrar from 'lib/TinyMCEActionRegistrar';\nimport React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport ReactDOM from 'react-dom';\nimport jQuery from 'jquery';\nimport ShortcodeSerialiser from 'lib/ShortcodeSerialiser';\nimport {createInsertLinkModal} from 'containers/InsertLinkModal/InsertLinkModal';\nimport {loadComponent} from 'lib/Injector';\nimport 'lang/en.js';\n\nconst commandName = 'sslinkcustomclass';\n\n// Link to phone number\nTinyMCEActionRegistrar\n    .addAction('sslink', {\n        text: i18n._t('Admin.LINKLABEL_CUSTOMCLASS', 'Link to custom class'),\n        // eslint-disable-next-line no-console\n        onclick: (editor) => editor.execCommand(commandName),\n        priority: 51,\n    })\n    .addCommandWithUrlTest(commandName, /^tel:/);\n\nconst plugin = {\n    init(editor) {\n        editor.addCommand(commandName, () => {\n           \n            const field = window.jQuery(`#${editor.id}`).entwine('ss');\n           \n            field.openLinkCustomClassDiaglog();\n        });\n    },\n};\n\nconst modalId = 'insert-link__dialog-wrapper--customclass';\nconst sectionConfigKey = 'SilverStripe\\\\Admin\\\\LeftAndMain';\nconst formName = 'EditorCustomClass';\n\nconst InsertLinkCustomClassModal = loadComponent(createInsertLinkModal(sectionConfigKey, formName));\n\njQuery.entwine('ss', ($) => {\n    $('textarea.htmleditor').entwine({\n        openLinkCustomClassDiaglog() {\n            let dialog = $(`#${modalId}`);\n\n            console.log(dialog);\n\n            if (!dialog.length) {\n                dialog = $(`<div id=\"${modalId}\" />`);\n                $('body').append(dialog);\n            }\n            dialog.addClass('insert-link__dialog-wrapper');\n\n            dialog.setElement(this);\n            dialog.open();\n        },\n    });\n   \n    /**\n     * Assumes that $('.insert-link__dialog-wrapper').entwine({}); is defined for shared functions\n     */\n    $(`#${modalId}`).entwine({\n        renderModal(isOpen) {\n            const handleHide = () => this.close();\n            const handleInsert = (...args) => this.handleInsert(...args);\n            const attrs = this.getOriginalAttributes();\n            const selection = tinymce.activeEditor.selection;\n            const selectionContent = selection.getContent() || '';\n            const tagName = selection.getNode().tagName;\n            const requireLinkText = tagName !== 'A' && selectionContent.trim() === '';\n\n            // create/update the react component\n            // let root = this.getReactRoot();\n            // if (!root) {\n            //     root = createRoot(this[0]);\n            //     this.setReactRoot(root);\n            // }\n            \n            ReactDOM.render(\n                <InsertLinkCustomClassModal\n                isOpen={isOpen}\n                onInsert={handleInsert}\n                onClosed={handleHide}\n                title={i18n._t('Admin.LINK_CUSTOMCLASS', 'Insert custom class')}\n                bodyClassName=\"modal__dialog\"\n                className=\"insert-link__dialog-wrapper--phone\"\n                fileAttributes={attrs}\n                identifier=\"Admin.InsertLinkPhoneModal\"\n                requireLinkText={requireLinkText}\n                />,\n                this[0]\n            );\n\n        },\n\n        getOriginalAttributes() {\n            const editor = this.getElement().getEditor();\n            const node = $(editor.getSelectedNode());\n      \n            // Get href\n            const hrefParts = (node.attr('href') || '').split('#');\n            if (!hrefParts[0]) {\n              return {};\n            }\n      \n            // check if page is safe\n            const shortcode = ShortcodeSerialiser.match('sitetree_link', false, hrefParts[0]);\n            if (!shortcode) {\n              return {};\n            }\n      \n            return {\n              PageID: shortcode.properties.id ? parseInt(shortcode.properties.id, 10) : 0,\n              Anchor: hrefParts[1] || '',\n              Description: node.attr('title'),\n              TargetBlank: !!node.attr('target'),\n              CustomClass: node.attr('class') || '',\n            };\n        },\n\n        buildAttributes(data) {\n            const shortcode = ShortcodeSerialiser.serialise({\n                name: 'sitetree_link',\n                properties: { id: data.PageID },\n              }, true);\n        \n              // Add anchor\n              const anchor = data.Anchor && data.Anchor.length ? `#${data.Anchor}` : '';\n              const href = `${shortcode}${anchor}`;\n        \n              return {\n                href,\n                target: data.TargetBlank ? '_blank' : '',\n                title: data.Description,\n                class: data.CustomClass || '' // Use the class string directly\n              };\n        },\n    });\n});\n\n// Adds the plugin class to the list of available TinyMCE plugins\ntinymce.PluginManager.add(commandName, (editor) => plugin.init(editor));\nexport default plugin;\n\n\n\n// WEBPACK FOOTER //\n// ./client/src/TinyMCE_sslink-customclass.js","if(typeof(i18n) == 'undefined') {\n    console.error('Class i18n not defined');\n} else {\n    i18n.addDictionary('en', {\n        \"Admin.LINKLABEL_CUSTOMCLASS\": \"Link to Custom class\",\n        \"Admin.LINK_CUSTOMCLASS\": \"Insert Custom class link\"\n    });\n}\n\n\n// WEBPACK FOOTER //\n// ./client/src/lang/en.js","module.exports = ReactDom;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ReactDom\"\n// module id = 0\n// module chunks = 0","module.exports = Injector;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Injector\"\n// module id = 1\n// module chunks = 0","module.exports = InsertLinkModal;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"InsertLinkModal\"\n// module id = 2\n// module chunks = 0","module.exports = React;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"React\"\n// module id = 3\n// module chunks = 0","module.exports = ShortcodeSerialiser;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ShortcodeSerialiser\"\n// module id = 4\n// module chunks = 0","module.exports = TinyMCEActionRegistrar;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"TinyMCEActionRegistrar\"\n// module id = 5\n// module chunks = 0","module.exports = i18n;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"i18n\"\n// module id = 6\n// module chunks = 0","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 7\n// module chunks = 0"],"sourceRoot":""}